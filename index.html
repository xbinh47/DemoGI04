<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap"
    rel="stylesheet" />

  <title>Demo Day - HTLO-C4K-GI04</title>
  <link rel="icon" href="assets/images/favicon.fafa9193.ico" />

  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />

  <!-- Additional CSS Files -->
  <link rel="stylesheet" href="assets/css/fontawesome.css" />
  <link rel="stylesheet" href="assets/css/templatemo-cyborg-gaming.css" />
  <link rel="stylesheet" href="assets/css/owl.css" />
  <link rel="stylesheet" href="assets/css/animate.css" />
  <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css" />
  <!--
-->
</head>

<body>
  <!-- ***** Header Area Start ***** -->
  <header class="header-area">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <nav class="main-nav">
            <!-- ***** Logo Start ***** -->
            <a href="index.html" class="logo">
              <img src="./assets/images/logo.png" alt="" />
            </a>
            <!-- ***** Logo End ***** -->
          </nav>
        </div>
      </div>
    </div>
  </header>
  <!-- ***** Header Area End ***** -->

  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="page-content">

          <!-- ***** Banner Start ***** -->
          <div class="main-banner">
            <div class="row">
              <div class="col-lg-7">
                <div class="header-text">
                  <h6>Welcome To MindX</h6>
                  <h4><em>HTLO-C4K-GI04</em></h4>
                  <h4>DEMO DAY</h4>
                </div>
              </div>
            </div>
          </div>
          <!-- ***** Banner End ***** -->

          <!-- ***** Most Popular Start ***** -->
          <div class="most-popular">
            <div class="row">
              <div class="col-lg-12">
                <div class="heading-section">
                  <h4><em>Games Demo</em></h4>
                </div>
                <div class="row">
                  <div class="col-lg-3 col-sm-6">
                    <div class="item" item-id="5">
                      <a onclick="window.open('https://tranvobaokhanh.github.io/FinalProjectGI ');""
                          ><img src=" assets/images/popular-01.jpg" alt="https://EMO2010.github.io/FinalProjectGI/" /></a>
                      <h4>Trần Võ Bảo Khánh<br /><span>Game</span></h4>
                      <ul>
                        <li><i class="fa fa-star"></i></li>
                      </ul>
                      <div class="col-lg-12">
                        <div class="main-button">
                          <button class="vote-button" data-item-id="5">Vote</button>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-lg-3 col-sm-6">
                    <div class="item" item-id="6">
                      <a onclick="window.open('https://thongVuV.github.io/FinalProjectGI');""
                          ><img src=" assets/images/popular-01.jpg" alt="" /></a>
                      <h4>Vũ Tuấn Thông<br /><span>Game</span></h4>
                      <ul>
                        <li><i class="fa fa-star"></i></li>
                      </ul>
                      <div class="col-lg-12">
                        <div class="main-button">
                          <button class="vote-button" data-item-id="6">Vote</button>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-lg-3 col-sm-6">
                    <div class="item" item-id="7">
                      <a onclick="window.open('https://baodel.github.io/FinalProjectGI');""
                          ><img src=" assets/images/popular-01.jpg" alt="" /></a>
                      <h4>Liêu Gia Bảo<br /><span>Game</span></h4>
                      <ul>
                        <li><i class="fa fa-star"></i></li>
                      </ul>
                      <div class="col-lg-12">
                        <div class="main-button">
                          <button class="vote-button" data-item-id="7">Vote</button>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-lg-3 col-sm-6">
                    <div class="item" item-id="8">
                      <a onclick="window.open('https://DuongGiaPhatGAMING.github.io/FinalProjectGI');""
                          ><img src=" assets/images/popular-01.jpg" alt="" /></a>
                      <h4>Dương Gia Phát<br /><span>Game</span></h4>
                      <ul>
                        <li><i class="fa fa-star"></i></li>
                      </ul>
                      <div class="col-lg-12">
                        <div class="main-button">
                          <button class="vote-button" data-item-id="8">Vote</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- ***** Most Popular End ***** -->

        </div>
      </div>
    </div>
  </div>

  <footer>
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <p>
            Copyright © 2024 <a href="#">JackOr</a>. All rights reserved.
            <br />Design:
            <a>JackOr&X.Binh</a>
          </p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.min.js"></script>

  <script src="assets/js/isotope.min.js"></script>
  <script src="assets/js/owl-carousel.js"></script>
  <script src="assets/js/tabs.js"></script>
  <script src="assets/js/popup.js"></script>
  <script src="assets/js/custom.js"></script>
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, doc, getDoc, updateDoc, arrayUnion } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyB0WDTiSWyirMx5wjESrMZMW7tCrrcueSM",
      authDomain: "gi03-d0559.firebaseapp.com",
      projectId: "gi03-d0559",
      storageBucket: "gi03-d0559.appspot.com",
      messagingSenderId: "264965670321",
      appId: "1:264965670321:web:73b5e0a34c87c251b22990"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Accessing a specific document
    function fetchAndDisplayRatings() {
      const docRef = doc(db, 'rating', 'eazHF8OKaHabQPQic4Kt'); // Replace with your actual game document ID

      getDoc(docRef).then((docSnap) => {
        if (docSnap.exists()) {
          const data = docSnap.data();
          const rates = data.rate; // Assuming 'rate' is the field name for your ratings array

          // Display the fetched ratings on the page
          rates.forEach((rate, index) => {
            const ratingElement = document.querySelector(`.item[item-id="${index + 1}"] .fa-star`);
            if (ratingElement) {
              ratingElement.innerText = rate; // Update the text
            }
          });
        } else {
          console.log('No such document!');
        }
      }).catch((error) => {
        console.error('Error fetching document:', error);
      });
    }
    fetchAndDisplayRatings();
    function vote(itemId) {
      const arrayIndex = parseInt(itemId, 10) - 1; // Convert item-id to an array index
      const docRef = doc(db, 'rating', 'eazHF8OKaHabQPQic4Kt'); // Replace with your actual game document ID

      getDoc(docRef).then((docSnap) => {
        if (docSnap.exists()) {
          const data = docSnap.data();
          const rates = data.rate; // Use the correct field name for your rate array
          rates[arrayIndex] = (rates[arrayIndex] || 0) + 1; // Increment the rate

          // Update the document with the new rates array
          updateDoc(docRef, { rate: rates }).then(() => {
            // Update the displayed rate for this item
            const ratingElement = document.querySelector(`.item[item-id="${itemId}"] .fa-star`);
            if (ratingElement) {
              ratingElement.innerText = rates[arrayIndex].toString(); // Update the text
            }
          });
        } else {
          console.log('No such document!');
        }
      }).catch((error) => {
        console.error('Error updating document:', error);
      });
    }
    if (localStorage.getItem('voted')) {
      // Hide all vote buttons
      document.querySelectorAll('.main-button').forEach(button => {
        button.style.display = 'none'; // Hides the button by changing its display style
      });
    }
    document.querySelectorAll('.vote-button')?.forEach(button => {
      button.addEventListener('click', function () {
        localStorage.setItem('voted', true);
        const itemId = this.getAttribute('data-item-id');
        document.querySelectorAll('.main-button').forEach(button => {
          button.style.display = 'none'; // Hides the button by changing its display style
        });
        vote(itemId);
        fetchAndDisplayRatings();
      });
    });

  </script>

</body>

</html>
